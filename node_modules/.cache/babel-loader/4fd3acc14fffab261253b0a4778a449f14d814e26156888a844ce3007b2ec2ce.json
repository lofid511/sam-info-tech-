{"ast":null,"code":"import _objectSpread from\"C:/Users/R-TECH/Desktop/00/my-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// hystorique.js\n// Opens a modal window showing yearly history (\"Historique\") for all personnel.\n// Table: one row per personnel, columns grouped by month (Jan..Dec) with subcolumns:\n// - Jrs (days present), Salaire (gross for days present), Avance, Net à payer\n// You can change the year with +/- buttons or enter a year, then refresh data.\n// The module:\n// - exports openHistorique(detail) (named) and default export (for dynamic import)\n// - registers listeners for \"openHystorique\" and \"openHistorique\" events (compatibility)\n// - exposes window.openHistorique and window.openHystorique for console testing\n//\n// Usage:\n// - import './hystorique' in App.js to preload listener, or dynamic import from personel.js\n// - dispatch event: window.dispatchEvent(new CustomEvent(\"openHystorique\", { detail: { locale: \"fr\" } }))\n// - or call window.openHistorique({ locale: \"fr\" })\n//\n// Notes:\n// - This UI relies on backend APIs exposed to JS:\n//    window.pywebview.api.get_personnel() -> returns array of personnel\n//    window.pywebview.api.get_pointage(personnel_id, year, month) -> returns list of pointage records (month optional)\n//    window.pywebview.api.get_pointage_for_person_month(personnel_id, year, month) -> single record\n// - If backend methods are absent, the UI will show fallbacks and console warnings.\nimport React,{useEffect,useState}from\"react\";import ReactDOM from\"react-dom/client\";/* ---------------- Helpers ---------------- */import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function monthLabel(i){let locale=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"fr\";const monthsFr=[\"Jan\",\"Fév\",\"Mar\",\"Avr\",\"Mai\",\"Juin\",\"Juil\",\"Août\",\"Sep\",\"Oct\",\"Nov\",\"Déc\"];const monthsAr=[\"يناير\",\"فيفري\",\"مارس\",\"أبريل\",\"ماي\",\"جوان\",\"جويلية\",\"أوت\",\"سبتمبر\",\"أكتوبر\",\"نوفمبر\",\"ديسمبر\"];return locale===\"ar\"?monthsAr[i]:monthsFr[i];}function formatNumberSpaceDot(value){if(value===null||value===undefined||value===\"\")return\"\";const cleaned=String(value).replace(/\\s+/g,\"\").replace(\",\",\".\");const n=Number(cleaned);if(!Number.isFinite(n))return String(value);const parts=n.toFixed(2).split(\".\");parts[0]=parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g,\" \");return parts.join(\".\");}function safeNum(v){if(v===null||v===undefined||v===\"\")return 0;const n=Number(String(v).toString().replace(/\\s+/g,\"\").replace(\",\",\".\"));return Number.isFinite(n)?n:0;}/* ---------------- Modal Component ---------------- */function HistoriqueModal(_ref){let{detail={},onClose}=_ref;const locale=detail.locale||\"fr\";const[year,setYear]=useState(detail.year&&Number(detail.year)||new Date().getFullYear());const[personnel,setPersonnel]=useState([]);const[loading,setLoading]=useState(false);const[dataMap,setDataMap]=useState({});// { personId: { month: record } }\nconst[error,setError]=useState(null);useEffect(()=>{// load personnel on mount\nlet mounted=true;async function load(){try{setLoading(true);const ppl=window.pywebview&&window.pywebview.api&&window.pywebview.api.get_personnel?await window.pywebview.api.get_personnel():[];if(!mounted)return;setPersonnel(Array.isArray(ppl)?ppl:[]);}catch(e){console.warn(\"hystorique: failed to load personnel\",e);if(mounted)setPersonnel([]);}finally{if(mounted)setLoading(false);}}load();return()=>{mounted=false;};},[]);useEffect(()=>{// load pointage data for all personnel for the selected year\nlet mounted=true;async function loadYearData(){setLoading(true);setError(null);const map={};try{// fetch per-person records for the year (call backend get_pointage(personnel_id, year, null))\n// If backend supports batch, replace with a batch call.\nfor(const p of personnel){try{// get_pointage(personnel_id, year, month) with month null returns all for year (backend handles None)\nconst recs=window.pywebview&&window.pywebview.api&&window.pywebview.api.get_pointage?await window.pywebview.api.get_pointage(p.id,year,null):[];// normalize into month->record\nconst months={};if(Array.isArray(recs)){recs.forEach(r=>{const m=Number(r.month)||null;if(m&&m>=1&&m<=12)months[m]=r;});}map[p.id]=months;}catch(e){console.warn(\"hystorique: failed to load pointage for personnel\",p.id,e);map[p.id]={};}}if(!mounted)return;setDataMap(map);}catch(e){console.error(\"hystorique: unexpected error loading year data\",e);if(mounted)setError(\"Failed to load historique.\");}finally{if(mounted)setLoading(false);}}// only load after personnel list is present\nif(personnel&&personnel.length>0){loadYearData();}else{// clear map\nsetDataMap({});}return()=>{mounted=false;};},[personnel,year]);function prevYear(){setYear(y=>y-1);}function nextYear(){setYear(y=>y+1);}function onYearChange(e){const v=Number(e.target.value);if(!Number.isNaN(v))setYear(v);}function computeMonthValues(p,m){var _ref2,_rec$days_present;// p = personnel obj, m = 1..12\nconst months=dataMap[p.id]||{};const rec=months[m]||null;const days=rec?(_ref2=(_rec$days_present=rec.days_present)!==null&&_rec$days_present!==void 0?_rec$days_present:rec.days_present)!==null&&_ref2!==void 0?_ref2:0:0;// salary per day may be in rec.salary_per_day; fallback to p.salaire / totalWorkingDays handled in pointage UI\nconst salaryPerDay=rec?safeNum(rec.salary_per_day):0;const gross=salaryPerDay*safeNum(days);// advance: prefer rec stored advance? fallback to p.avance\nconst avance=rec&&\"avance\"in rec?safeNum(rec.avance):safeNum(p.avance);const net=rec&&\"salary_due\"in rec?safeNum(rec.salary_due):gross-avance;return{days,gross,avance,net};}// CSV export helper\nfunction exportCSV(){const headers=[\"Nom\",\"Prénom\"];for(let m=1;m<=12;m++){headers.push(\"\".concat(monthLabel(m-1,locale),\" Jrs\"));headers.push(\"\".concat(monthLabel(m-1,locale),\" Salaire\"));headers.push(\"\".concat(monthLabel(m-1,locale),\" Avance\"));headers.push(\"\".concat(monthLabel(m-1,locale),\" Net\"));}const rows=personnel.map(p=>{const row=[p.nom||\"\",p.prenom||\"\"];for(let m=1;m<=12;m++){const v=computeMonthValues(p,m);row.push(String(v.days||0));row.push(formatNumberSpaceDot(v.gross));row.push(formatNumberSpaceDot(v.avance));row.push(formatNumberSpaceDot(v.net));}return row;});const csv=[headers,...rows].map(r=>r.map(cell=>\"\\\"\".concat(String(cell).replace(/\"/g,'\"\"'),\"\\\"\")).join(\",\")).join(\"\\n\");const blob=new Blob([csv],{type:\"text/csv;charset=utf-8;\"});const url=URL.createObjectURL(blob);const a=document.createElement(\"a\");a.href=url;a.download=\"historique_\".concat(year,\".csv\");document.body.appendChild(a);a.click();a.remove();URL.revokeObjectURL(url);}return/*#__PURE__*/_jsx(\"div\",{style:styles.overlay,children:/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread(_objectSpread({},styles.modal),{},{direction:locale===\"ar\"?\"rtl\":\"ltr\",textAlign:locale===\"ar\"?\"right\":\"left\"}),children:[/*#__PURE__*/_jsxs(\"div\",{style:styles.header,children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:0},children:locale===\"ar\"?\"سجل الحضور السنوي\":\"Historique annuel \\u2014 \".concat(year)}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:8,alignItems:\"center\"},children:[/*#__PURE__*/_jsx(\"button\",{onClick:prevYear,style:styles.smallButton,children:\"\\u25C0\"}),/*#__PURE__*/_jsx(\"input\",{value:year,onChange:onYearChange,style:styles.yearInput}),/*#__PURE__*/_jsx(\"button\",{onClick:nextYear,style:styles.smallButton,children:\"\\u25B6\"}),/*#__PURE__*/_jsx(\"button\",{onClick:exportCSV,style:styles.csvButton,children:\"CSV\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:styles.closeButton,children:\"\\u2716\"})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:12},children:loading?/*#__PURE__*/_jsx(\"div\",{style:{padding:40,textAlign:\"center\"},children:locale===\"ar\"?\"جاري التحميل...\":\"Loading...\"}):error?/*#__PURE__*/_jsx(\"div\",{style:{color:\"red\"},children:error}):/*#__PURE__*/_jsx(\"div\",{style:{overflowX:\"auto\",width:\"100%\"},children:/*#__PURE__*/_jsxs(\"table\",{style:styles.table,children:[/*#__PURE__*/_jsxs(\"thead\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{rowSpan:2,style:{minWidth:200,textAlign:\"left\",padding:\"0.6rem\"},children:locale===\"ar\"?\"الاسم\":\"Nom et Prénom\"}),Array.from({length:12}).map((_,i)=>/*#__PURE__*/_jsx(\"th\",{colSpan:4,style:styles.monthHeader,children:monthLabel(i,locale)},i))]}),/*#__PURE__*/_jsx(\"tr\",{children:Array.from({length:12}).flatMap((_,i)=>[/*#__PURE__*/_jsx(\"th\",{style:styles.subHeader,children:\"Jrs\"},\"d-\".concat(i)),/*#__PURE__*/_jsx(\"th\",{style:styles.subHeader,children:\"Salaire\"},\"s-\".concat(i)),/*#__PURE__*/_jsx(\"th\",{style:styles.subHeader,children:\"Avance\"},\"a-\".concat(i)),/*#__PURE__*/_jsx(\"th\",{style:styles.subHeader,children:\"Net\"},\"n-\".concat(i))])})]}),/*#__PURE__*/_jsx(\"tbody\",{children:personnel.length===0?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:1+12*4,style:{padding:20,textAlign:\"center\"},children:locale===\"ar\"?\"لا يوجد موظفون\":\"No personnel found\"})}):personnel.map(p=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{style:styles.nameCell,children:[p.nom||\"\",\" \",p.prenom||\"\"]}),Array.from({length:12}).map((_,idx)=>{const m=idx+1;const v=computeMonthValues(p,m);return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(\"td\",{style:styles.cell,children:v.days||\"-\"}),/*#__PURE__*/_jsx(\"td\",{style:styles.cell,children:/*#__PURE__*/_jsx(\"span\",{style:styles.ltr,children:formatNumberSpaceDot(v.gross)})}),/*#__PURE__*/_jsx(\"td\",{style:styles.cell,children:/*#__PURE__*/_jsx(\"span\",{style:styles.ltr,children:formatNumberSpaceDot(v.avance)})}),/*#__PURE__*/_jsx(\"td\",{style:_objectSpread(_objectSpread({},styles.cell),{},{fontWeight:700,color:v.net<0?\"#c00\":\"#14355f\"}),children:/*#__PURE__*/_jsx(\"span\",{style:styles.ltr,children:formatNumberSpaceDot(v.net)})})]},\"\".concat(p.id,\"-\").concat(m));})]},p.id))})]})})})]})});}/* ---------------- Programmatic opener & event listeners ---------------- */export function openHistorique(){let detail=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};console.log(\"[hystorique] openHistorique called\",detail);const id=\"hystorique-modal-root\";let container=document.getElementById(id);if(!container){container=document.createElement(\"div\");container.id=id;document.body.appendChild(container);}function cleanup(root,containerEl){try{root.unmount();}catch(e){}try{containerEl.remove();}catch(e){}}try{const root=ReactDOM.createRoot(container);const onClose=()=>cleanup(root,container);root.render(/*#__PURE__*/_jsx(HistoriqueModal,{detail:detail,onClose:onClose}));}catch(err){// fallback for older React\ntry{// eslint-disable-next-line\nReactDOM.render(/*#__PURE__*/_jsx(HistoriqueModal,{detail:detail,onClose:()=>{try{ReactDOM.unmountComponentAtNode(container);}catch(e){}try{container.remove();}catch(e){}}}),container);}catch(e){console.error(\"[hystorique] failed to render modal:\",e);alert(\"Failed to open historique (see console).\");}}}// backward-compatible default export\nexport default openHistorique;// Register event listeners for both spellings used in the app\nfunction onOpenEvent(e){try{const detail=(e===null||e===void 0?void 0:e.detail)||{};openHistorique(detail);}catch(err){console.error(\"[hystorique] event handler error:\",err);}}try{window.addEventListener(\"openHystorique\",onOpenEvent);window.addEventListener(\"openHistorique\",onOpenEvent);window.openHistorique=window.openHistorique||openHistorique;window.openHystorique=window.openHystorique||openHistorique;console.log(\"[hystorique] module loaded and listeners registered\");}catch(e){console.warn(\"[hystorique] could not register event listeners\",e);}/* ---------------- Styles ---------------- */const styles={overlay:{position:\"fixed\",inset:0,background:\"rgba(0,0,0,0.45)\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",zIndex:9999},modal:{width:\"96%\",maxWidth:1200,maxHeight:\"90vh\",overflow:\"auto\",background:\"#fff\",borderRadius:10,padding:14,boxShadow:\"0 16px 40px rgba(0,0,0,0.35)\"},header:{display:\"flex\",justifyContent:\"space-between\",gap:12,alignItems:\"center\",marginBottom:8},smallButton:{padding:\"6px 8px\",borderRadius:6,border:\"1px solid #dbe9ff\",background:\"#fff\",cursor:\"pointer\"},yearInput:{width:88,padding:\"6px 8px\",borderRadius:6,border:\"1px solid #e0e0e0\",textAlign:\"center\"},csvButton:{padding:\"6px 10px\",borderRadius:6,border:\"none\",background:\"#3477eb\",color:\"#fff\",cursor:\"pointer\"},closeButton:{padding:\"6px 8px\",borderRadius:6,border:\"none\",background:\"#f4f6fb\",cursor:\"pointer\"},table:{width:\"100%\",borderCollapse:\"collapse\",fontSize:13,minWidth:900},monthHeader:{background:\"#f7fbff\",padding:\"8px 6px\",border:\"1px solid #eef6ff\",textAlign:\"center\",fontWeight:700},subHeader:{background:\"#fff\",padding:\"6px\",border:\"1px solid #f0f6ff\",textAlign:\"center\",fontWeight:700},nameCell:{padding:\"8px\",border:\"1px solid #eef6ff\",background:\"#fff\",fontWeight:700,minWidth:200},cell:{padding:\"6px 8px\",border:\"1px solid #f2f7ff\",textAlign:\"right\",whiteSpace:\"nowrap\"},ltr:{direction:\"ltr\",unicodeBidi:\"isolate\"}};","map":{"version":3,"names":["React","useEffect","useState","ReactDOM","jsx","_jsx","jsxs","_jsxs","monthLabel","i","locale","arguments","length","undefined","monthsFr","monthsAr","formatNumberSpaceDot","value","cleaned","String","replace","n","Number","isFinite","parts","toFixed","split","join","safeNum","v","toString","HistoriqueModal","_ref","detail","onClose","year","setYear","Date","getFullYear","personnel","setPersonnel","loading","setLoading","dataMap","setDataMap","error","setError","mounted","load","ppl","window","pywebview","api","get_personnel","Array","isArray","e","console","warn","loadYearData","map","p","recs","get_pointage","id","months","forEach","r","m","month","prevYear","y","nextYear","onYearChange","target","isNaN","computeMonthValues","_ref2","_rec$days_present","rec","days","days_present","salaryPerDay","salary_per_day","gross","avance","net","salary_due","exportCSV","headers","push","concat","rows","row","nom","prenom","csv","cell","blob","Blob","type","url","URL","createObjectURL","a","document","createElement","href","download","body","appendChild","click","remove","revokeObjectURL","style","styles","overlay","children","_objectSpread","modal","direction","textAlign","header","margin","display","gap","alignItems","onClick","smallButton","onChange","yearInput","csvButton","closeButton","marginTop","padding","color","overflowX","width","table","rowSpan","minWidth","from","_","colSpan","monthHeader","flatMap","subHeader","nameCell","idx","Fragment","ltr","fontWeight","openHistorique","log","container","getElementById","cleanup","root","containerEl","unmount","createRoot","render","err","unmountComponentAtNode","alert","onOpenEvent","addEventListener","openHystorique","position","inset","background","justifyContent","zIndex","maxWidth","maxHeight","overflow","borderRadius","boxShadow","marginBottom","border","cursor","borderCollapse","fontSize","whiteSpace","unicodeBidi"],"sources":["C:/Users/R-TECH/Desktop/00/my-app/src/hystorique.js"],"sourcesContent":["// hystorique.js\n// Opens a modal window showing yearly history (\"Historique\") for all personnel.\n// Table: one row per personnel, columns grouped by month (Jan..Dec) with subcolumns:\n// - Jrs (days present), Salaire (gross for days present), Avance, Net à payer\n// You can change the year with +/- buttons or enter a year, then refresh data.\n// The module:\n// - exports openHistorique(detail) (named) and default export (for dynamic import)\n// - registers listeners for \"openHystorique\" and \"openHistorique\" events (compatibility)\n// - exposes window.openHistorique and window.openHystorique for console testing\n//\n// Usage:\n// - import './hystorique' in App.js to preload listener, or dynamic import from personel.js\n// - dispatch event: window.dispatchEvent(new CustomEvent(\"openHystorique\", { detail: { locale: \"fr\" } }))\n// - or call window.openHistorique({ locale: \"fr\" })\n//\n// Notes:\n// - This UI relies on backend APIs exposed to JS:\n//    window.pywebview.api.get_personnel() -> returns array of personnel\n//    window.pywebview.api.get_pointage(personnel_id, year, month) -> returns list of pointage records (month optional)\n//    window.pywebview.api.get_pointage_for_person_month(personnel_id, year, month) -> single record\n// - If backend methods are absent, the UI will show fallbacks and console warnings.\n\nimport React, { useEffect, useState } from \"react\";\nimport ReactDOM from \"react-dom/client\";\n\n/* ---------------- Helpers ---------------- */\n\nfunction monthLabel(i, locale = \"fr\") {\n  const monthsFr = [\"Jan\", \"Fév\", \"Mar\", \"Avr\", \"Mai\", \"Juin\", \"Juil\", \"Août\", \"Sep\", \"Oct\", \"Nov\", \"Déc\"];\n  const monthsAr = [\"يناير\",\"فيفري\",\"مارس\",\"أبريل\",\"ماي\",\"جوان\",\"جويلية\",\"أوت\",\"سبتمبر\",\"أكتوبر\",\"نوفمبر\",\"ديسمبر\"];\n  return locale === \"ar\" ? monthsAr[i] : monthsFr[i];\n}\n\nfunction formatNumberSpaceDot(value) {\n  if (value === null || value === undefined || value === \"\") return \"\";\n  const cleaned = String(value).replace(/\\s+/g, \"\").replace(\",\", \".\");\n  const n = Number(cleaned);\n  if (!Number.isFinite(n)) return String(value);\n  const parts = n.toFixed(2).split(\".\");\n  parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \" \");\n  return parts.join(\".\");\n}\n\nfunction safeNum(v) {\n  if (v === null || v === undefined || v === \"\") return 0;\n  const n = Number(String(v).toString().replace(/\\s+/g, \"\").replace(\",\", \".\"));\n  return Number.isFinite(n) ? n : 0;\n}\n\n/* ---------------- Modal Component ---------------- */\n\nfunction HistoriqueModal({ detail = {}, onClose }) {\n  const locale = detail.locale || \"fr\";\n  const [year, setYear] = useState((detail.year && Number(detail.year)) || new Date().getFullYear());\n  const [personnel, setPersonnel] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [dataMap, setDataMap] = useState({}); // { personId: { month: record } }\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    // load personnel on mount\n    let mounted = true;\n    async function load() {\n      try {\n        setLoading(true);\n        const ppl = (window.pywebview && window.pywebview.api && window.pywebview.api.get_personnel)\n          ? await window.pywebview.api.get_personnel()\n          : [];\n        if (!mounted) return;\n        setPersonnel(Array.isArray(ppl) ? ppl : []);\n      } catch (e) {\n        console.warn(\"hystorique: failed to load personnel\", e);\n        if (mounted) setPersonnel([]);\n      } finally {\n        if (mounted) setLoading(false);\n      }\n    }\n    load();\n    return () => { mounted = false; };\n  }, []);\n\n  useEffect(() => {\n    // load pointage data for all personnel for the selected year\n    let mounted = true;\n    async function loadYearData() {\n      setLoading(true);\n      setError(null);\n      const map = {};\n      try {\n        // fetch per-person records for the year (call backend get_pointage(personnel_id, year, null))\n        // If backend supports batch, replace with a batch call.\n        for (const p of personnel) {\n          try {\n            // get_pointage(personnel_id, year, month) with month null returns all for year (backend handles None)\n            const recs = (window.pywebview && window.pywebview.api && window.pywebview.api.get_pointage)\n              ? await window.pywebview.api.get_pointage(p.id, year, null)\n              : [];\n            // normalize into month->record\n            const months = {};\n            if (Array.isArray(recs)) {\n              recs.forEach(r => {\n                const m = Number(r.month) || null;\n                if (m && m >= 1 && m <= 12) months[m] = r;\n              });\n            }\n            map[p.id] = months;\n          } catch (e) {\n            console.warn(\"hystorique: failed to load pointage for personnel\", p.id, e);\n            map[p.id] = {};\n          }\n        }\n        if (!mounted) return;\n        setDataMap(map);\n      } catch (e) {\n        console.error(\"hystorique: unexpected error loading year data\", e);\n        if (mounted) setError(\"Failed to load historique.\");\n      } finally {\n        if (mounted) setLoading(false);\n      }\n    }\n    // only load after personnel list is present\n    if (personnel && personnel.length > 0) {\n      loadYearData();\n    } else {\n      // clear map\n      setDataMap({});\n    }\n    return () => { mounted = false; };\n  }, [personnel, year]);\n\n  function prevYear() { setYear(y => y - 1); }\n  function nextYear() { setYear(y => y + 1); }\n  function onYearChange(e) {\n    const v = Number(e.target.value);\n    if (!Number.isNaN(v)) setYear(v);\n  }\n\n  function computeMonthValues(p, m) {\n    // p = personnel obj, m = 1..12\n    const months = dataMap[p.id] || {};\n    const rec = months[m] || null;\n    const days = rec ? (rec.days_present ?? rec.days_present ?? 0) : 0;\n    // salary per day may be in rec.salary_per_day; fallback to p.salaire / totalWorkingDays handled in pointage UI\n    const salaryPerDay = rec ? safeNum(rec.salary_per_day) : 0;\n    const gross = salaryPerDay * safeNum(days);\n    // advance: prefer rec stored advance? fallback to p.avance\n    const avance = rec && (\"avance\" in rec) ? safeNum(rec.avance) : safeNum(p.avance);\n    const net = (rec && (\"salary_due\" in rec)) ? safeNum(rec.salary_due) : (gross - avance);\n    return {\n      days, gross, avance, net\n    };\n  }\n\n  // CSV export helper\n  function exportCSV() {\n    const headers = [\"Nom\", \"Prénom\"];\n    for (let m = 1; m <= 12; m++) {\n      headers.push(`${monthLabel(m-1, locale)} Jrs`);\n      headers.push(`${monthLabel(m-1, locale)} Salaire`);\n      headers.push(`${monthLabel(m-1, locale)} Avance`);\n      headers.push(`${monthLabel(m-1, locale)} Net`);\n    }\n    const rows = personnel.map(p => {\n      const row = [p.nom || \"\", p.prenom || \"\"];\n      for (let m = 1; m <= 12; m++) {\n        const v = computeMonthValues(p, m);\n        row.push(String(v.days || 0));\n        row.push(formatNumberSpaceDot(v.gross));\n        row.push(formatNumberSpaceDot(v.avance));\n        row.push(formatNumberSpaceDot(v.net));\n      }\n      return row;\n    });\n    const csv = [headers, ...rows].map(r => r.map(cell => `\"${String(cell).replace(/\"/g, '\"\"')}\"`).join(\",\")).join(\"\\n\");\n    const blob = new Blob([csv], { type: \"text/csv;charset=utf-8;\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `historique_${year}.csv`;\n    document.body.appendChild(a);\n    a.click();\n    a.remove();\n    URL.revokeObjectURL(url);\n  }\n\n  return (\n    <div style={styles.overlay}>\n      <div style={{ ...styles.modal, direction: locale === \"ar\" ? \"rtl\" : \"ltr\", textAlign: locale === \"ar\" ? \"right\" : \"left\" }}>\n        <div style={styles.header}>\n          <h3 style={{ margin: 0 }}>{locale === \"ar\" ? \"سجل الحضور السنوي\" : `Historique annuel — ${year}`}</h3>\n          <div style={{ display: \"flex\", gap: 8, alignItems: \"center\" }}>\n            <button onClick={prevYear} style={styles.smallButton}>◀</button>\n            <input value={year} onChange={onYearChange} style={styles.yearInput} />\n            <button onClick={nextYear} style={styles.smallButton}>▶</button>\n            <button onClick={exportCSV} style={styles.csvButton}>CSV</button>\n            <button onClick={onClose} style={styles.closeButton}>✖</button>\n          </div>\n        </div>\n\n        <div style={{ marginTop: 12 }}>\n          {loading ? (\n            <div style={{ padding: 40, textAlign: \"center\" }}>{locale === \"ar\" ? \"جاري التحميل...\" : \"Loading...\"}</div>\n          ) : error ? (\n            <div style={{ color: \"red\" }}>{error}</div>\n          ) : (\n            <div style={{ overflowX: \"auto\", width: \"100%\" }}>\n              <table style={styles.table}>\n                <thead>\n                  <tr>\n                    <th rowSpan={2} style={{ minWidth: 200, textAlign: \"left\", padding: \"0.6rem\" }}>{locale === \"ar\" ? \"الاسم\" : \"Nom et Prénom\"}</th>\n                    {Array.from({ length: 12 }).map((_, i) => (\n                      <th key={i} colSpan={4} style={styles.monthHeader}>{monthLabel(i, locale)}</th>\n                    ))}\n                  </tr>\n                  <tr>\n                    {Array.from({ length: 12 }).flatMap((_, i) => ([\n                      <th key={`d-${i}`} style={styles.subHeader}>Jrs</th>,\n                      <th key={`s-${i}`} style={styles.subHeader}>Salaire</th>,\n                      <th key={`a-${i}`} style={styles.subHeader}>Avance</th>,\n                      <th key={`n-${i}`} style={styles.subHeader}>Net</th>\n                    ]))}\n                  </tr>\n                </thead>\n                <tbody>\n                  {personnel.length === 0 ? (\n                    <tr><td colSpan={1 + 12*4} style={{ padding: 20, textAlign: \"center\" }}>{locale === \"ar\" ? \"لا يوجد موظفون\" : \"No personnel found\"}</td></tr>\n                  ) : personnel.map(p => (\n                    <tr key={p.id}>\n                      <td style={styles.nameCell}>{p.nom || \"\"} {p.prenom || \"\"}</td>\n                      {Array.from({ length: 12 }).map((_, idx) => {\n                        const m = idx + 1;\n                        const v = computeMonthValues(p, m);\n                        return (\n                          <React.Fragment key={`${p.id}-${m}`}>\n                            <td style={styles.cell}>{v.days || \"-\"}</td>\n                            <td style={styles.cell}><span style={styles.ltr}>{formatNumberSpaceDot(v.gross)}</span></td>\n                            <td style={styles.cell}><span style={styles.ltr}>{formatNumberSpaceDot(v.avance)}</span></td>\n                            <td style={{ ...styles.cell, fontWeight: 700, color: v.net < 0 ? \"#c00\" : \"#14355f\" }}>\n                              <span style={styles.ltr}>{formatNumberSpaceDot(v.net)}</span>\n                            </td>\n                          </React.Fragment>\n                        );\n                      })}\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\n/* ---------------- Programmatic opener & event listeners ---------------- */\n\nexport function openHistorique(detail = {}) {\n  console.log(\"[hystorique] openHistorique called\", detail);\n  const id = \"hystorique-modal-root\";\n  let container = document.getElementById(id);\n  if (!container) {\n    container = document.createElement(\"div\");\n    container.id = id;\n    document.body.appendChild(container);\n  }\n\n  function cleanup(root, containerEl) {\n    try { root.unmount(); } catch (e) {}\n    try { containerEl.remove(); } catch (e) {}\n  }\n\n  try {\n    const root = ReactDOM.createRoot(container);\n    const onClose = () => cleanup(root, container);\n    root.render(<HistoriqueModal detail={detail} onClose={onClose} />);\n  } catch (err) {\n    // fallback for older React\n    try {\n      // eslint-disable-next-line\n      ReactDOM.render(<HistoriqueModal detail={detail} onClose={() => {\n        try { ReactDOM.unmountComponentAtNode(container); } catch (e) {}\n        try { container.remove(); } catch (e) {}\n      }} />, container);\n    } catch (e) {\n      console.error(\"[hystorique] failed to render modal:\", e);\n      alert(\"Failed to open historique (see console).\");\n    }\n  }\n}\n\n// backward-compatible default export\nexport default openHistorique;\n\n// Register event listeners for both spellings used in the app\nfunction onOpenEvent(e) {\n  try {\n    const detail = e?.detail || {};\n    openHistorique(detail);\n  } catch (err) {\n    console.error(\"[hystorique] event handler error:\", err);\n  }\n}\n\ntry {\n  window.addEventListener(\"openHystorique\", onOpenEvent);\n  window.addEventListener(\"openHistorique\", onOpenEvent);\n  window.openHistorique = window.openHistorique || openHistorique;\n  window.openHystorique = window.openHystorique || openHistorique;\n  console.log(\"[hystorique] module loaded and listeners registered\");\n} catch (e) {\n  console.warn(\"[hystorique] could not register event listeners\", e);\n}\n\n/* ---------------- Styles ---------------- */\n\nconst styles = {\n  overlay: {\n    position: \"fixed\",\n    inset: 0,\n    background: \"rgba(0,0,0,0.45)\",\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    zIndex: 9999\n  },\n  modal: {\n    width: \"96%\",\n    maxWidth: 1200,\n    maxHeight: \"90vh\",\n    overflow: \"auto\",\n    background: \"#fff\",\n    borderRadius: 10,\n    padding: 14,\n    boxShadow: \"0 16px 40px rgba(0,0,0,0.35)\"\n  },\n  header: {\n    display: \"flex\",\n    justifyContent: \"space-between\",\n    gap: 12,\n    alignItems: \"center\",\n    marginBottom: 8\n  },\n  smallButton: {\n    padding: \"6px 8px\",\n    borderRadius: 6,\n    border: \"1px solid #dbe9ff\",\n    background: \"#fff\",\n    cursor: \"pointer\"\n  },\n  yearInput: {\n    width: 88,\n    padding: \"6px 8px\",\n    borderRadius: 6,\n    border: \"1px solid #e0e0e0\",\n    textAlign: \"center\"\n  },\n  csvButton: {\n    padding: \"6px 10px\",\n    borderRadius: 6,\n    border: \"none\",\n    background: \"#3477eb\",\n    color: \"#fff\",\n    cursor: \"pointer\"\n  },\n  closeButton: {\n    padding: \"6px 8px\",\n    borderRadius: 6,\n    border: \"none\",\n    background: \"#f4f6fb\",\n    cursor: \"pointer\"\n  },\n  table: {\n    width: \"100%\",\n    borderCollapse: \"collapse\",\n    fontSize: 13,\n    minWidth: 900\n  },\n  monthHeader: {\n    background: \"#f7fbff\",\n    padding: \"8px 6px\",\n    border: \"1px solid #eef6ff\",\n    textAlign: \"center\",\n    fontWeight: 700\n  },\n  subHeader: {\n    background: \"#fff\",\n    padding: \"6px\",\n    border: \"1px solid #f0f6ff\",\n    textAlign: \"center\",\n    fontWeight: 700\n  },\n  nameCell: {\n    padding: \"8px\",\n    border: \"1px solid #eef6ff\",\n    background: \"#fff\",\n    fontWeight: 700,\n    minWidth: 200\n  },\n  cell: {\n    padding: \"6px 8px\",\n    border: \"1px solid #f2f7ff\",\n    textAlign: \"right\",\n    whiteSpace: \"nowrap\"\n  },\n  ltr: {\n    direction: \"ltr\",\n    unicodeBidi: \"isolate\"\n  }\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}